<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style>
  /*
   * I add this to html files generated with pandoc.
   */
  
  html {
    font-size: 100%;
    overflow-y: scroll;
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
  }
  
  body {
    color: #444;
    font-family: Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif;
    font-size: 12px;
    line-height: 1.7;
    padding: 1em;
    margin: auto;
    max-width: 42em;
    background: #fefefe;
  }
  
  a {
    color: #0645ad;
    text-decoration: none;
  }
  
  a:visited {
    color: #0b0080;
  }
  
  a:hover {
    color: #06e;
  }
  
  a:active {
    color: #faa700;
  }
  
  a:focus {
    outline: thin dotted;
  }
  
  *::-moz-selection {
    background: rgba(255, 255, 0, 0.3);
    color: #000;
  }
  
  *::selection {
    background: rgba(255, 255, 0, 0.3);
    color: #000;
  }
  
  a::-moz-selection {
    background: rgba(255, 255, 0, 0.3);
    color: #0645ad;
  }
  
  a::selection {
    background: rgba(255, 255, 0, 0.3);
    color: #0645ad;
  }
  
  p {
    margin: 1em 0;
  }
  
  img {
    max-width: 100%;
  }
  
  h1, h2, h3, h4, h5, h6 {
    color: #111;
    line-height: 125%;
    margin-top: 2em;
    font-weight: normal;
  }
  
  h4, h5, h6 {
    font-weight: bold;
  }
  
  h1 {
    font-size: 2.5em;
  }
  
  h2 {
    font-size: 2em;
  }
  
  h3 {
    font-size: 1.5em;
  }
  
  h4 {
    font-size: 1.2em;
  }
  
  h5 {
    font-size: 1em;
  }
  
  h6 {
    font-size: 0.9em;
  }
  
  blockquote {
    color: #666666;
    margin: 0;
    padding-left: 3em;
    border-left: 0.5em #EEE solid;
  }
  
  hr {
    display: block;
    height: 2px;
    border: 0;
    border-top: 1px solid #aaa;
    border-bottom: 1px solid #eee;
    margin: 1em 0;
    padding: 0;
  }
  
  pre, code, kbd, samp {
    color: #000;
    font-family: monospace, monospace;
    _font-family: 'courier new', monospace;
    font-size: 0.98em;
  }
  
  pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  b, strong {
    font-weight: bold;
  }
  
  dfn {
    font-style: italic;
  }
  
  ins {
    background: #ff9;
    color: #000;
    text-decoration: none;
  }
  
  mark {
    background: #ff0;
    color: #000;
    font-style: italic;
    font-weight: bold;
  }
  
  sub, sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
  }
  
  sup {
    top: -0.5em;
  }
  
  sub {
    bottom: -0.25em;
  }
  
  ul, ol {
    margin: 1em 0;
    padding: 0 0 0 2em;
  }
  
  li p:last-child {
    margin-bottom: 0;
  }
  
  ul ul, ol ol {
    margin: .3em 0;
  }
  
  dl {
    margin-bottom: 1em;
  }
  
  dt {
    font-weight: bold;
    margin-bottom: .8em;
  }
  
  dd {
    margin: 0 0 .8em 2em;
  }
  
  dd:last-child {
    margin-bottom: 0;
  }
  
  img {
    border: 0;
    -ms-interpolation-mode: bicubic;
    vertical-align: middle;
  }
  
  figure {
    display: block;
    text-align: center;
    margin: 1em 0;
  }
  
  figure img {
    border: none;
    margin: 0 auto;
  }
  
  figcaption {
    font-size: 0.8em;
    font-style: italic;
    margin: 0 0 .8em;
  }
  
  table {
    margin-bottom: 2em;
    border-bottom: 1px solid #ddd;
    border-right: 1px solid #ddd;
    border-spacing: 0;
    border-collapse: collapse;
  }
  
  table th {
    padding: .2em 1em;
    background-color: #eee;
    border-top: 1px solid #ddd;
    border-left: 1px solid #ddd;
  }
  
  table td {
    padding: .2em 1em;
    border-top: 1px solid #ddd;
    border-left: 1px solid #ddd;
    vertical-align: top;
  }
  
  .author {
    font-size: 1.2em;
    text-align: center;
  }
  
  @media only screen and (min-width: 480px) {
    body {
      font-size: 14px;
    }
  }
  @media only screen and (min-width: 768px) {
    body {
      font-size: 16px;
    }
  }
  @media print {
    * {
      background: transparent !important;
      color: black !important;
      filter: none !important;
      -ms-filter: none !important;
    }
  
    body {
      font-size: 12pt;
      max-width: 100%;
    }
  
    a, a:visited {
      text-decoration: underline;
    }
  
    hr {
      height: 1px;
      border: 0;
      border-bottom: 1px solid black;
    }
  
    a[href]:after {
      content: " (" attr(href) ")";
    }
  
    abbr[title]:after {
      content: " (" attr(title) ")";
    }
  
    .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after {
      content: "";
    }
  
    pre, blockquote {
      border: 1px solid #999;
      padding-right: 1em;
      page-break-inside: avoid;
    }
  
    tr, img {
      page-break-inside: avoid;
    }
  
    img {
      max-width: 100% !important;
    }
  
    @page :left {
      margin: 15mm 20mm 15mm 10mm;
  }
  
    @page :right {
      margin: 15mm 10mm 15mm 20mm;
  }
  
    p, h2, h3 {
      orphans: 3;
      widows: 3;
    }
  
    h2, h3 {
      page-break-after: avoid;
    }
  }
  </style>
</head>
<body>
<h1 id="imgtool-imgtool---jpeg-photo-tool">imgtool Imgtool - JPEG Photo tool</h1>
<h2 id="descrtiption">Descrtiption</h2>
<p>imgtool is a tool for dating, renaming, organizing, resizing, rotating and thumbnailing images based on the information stored in their EXIF header. This is to aid in the processing and organizing of digital photography images.</p>
<h2 id="background">Background</h2>
<p>With a fairly large collection of digital photos I have taken with my phone and three different Nikon cameras.</p>
<p>In an effort to have unqique file names, I wrote this tool. I also added the functionality of a couple other operations I frequently do in post- processing.</p>
<p>A number of graphics tools will honor the Orientation tag in an image, however, on occasion, I find I need to manually rotate an image. More commonly, images get resized and renamed. Sometimes other tools are employed which modify the timestamp of the file, on the files system, which can disrupt sorting. (I use a date descending order in my file manager to show me the most recent photos) The default operation of imgtool is to set the timestamp of the files it finds with the date stamp in the photo's EXIF header.</p>
<p>Files can be moved (or copied if to a different device) to another directory. The naming can have embedded exif data just like the format option. This would allow creation of a directory structure based on image data. E.g., <code>~/Photos/#Y-#m-#d .</code> will create a tree of directories based on the EXIF (or file) Date/Time. Any subdirectory trees are maintained.</p>
<p><em>If an output directory is specified, and, no other renaming is done, for operations such as dating or resizing, the file is <strong>copied</strong> to the output directory instead of renaming.</em></p>
<h2 id="digital-photography-images">Digital Photography Images</h2>
<p>Files created by digital photography have a header built-in called <em>Exhangeabe Image Format</em> or EXIF (https://en.wikipedia.org/wiki/Exif) header. There is a lot of information that can be in this header that relates to the photograph, when it was taken, sometimes where it was taken, camera settings, camera model, etc. This tool extracts this information and uses it to create unique names for photography files, rotate them, etc.</p>
<ul>
<li><a href="#usage">Usage</a>
<ul>
<li><a href="#program-options">Program Options</a></li>
</ul></li>
<li><a href="#geometry">Geometry</a></li>
<li><a href="#order-of-operations">Order of operations</a></li>
<li><a href="#automatic-image-naming">Automatic Image Naming</a>
<ul>
<li><a href="#splitting-strings-in-tags">Splitting strings in tags</a></li>
</ul></li>
<li><a href="#some-tips">Some tips</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#pre-requisites">Pre-requisites</a>
<ul>
<li><a href="#running-the-installer-script:">Running the installer script:</a></li>
</ul></li>
<li><a href="#issues">Issues</a></li>
<li><a href="#warning">WARNING</a></li>
<li><a href="#author">Author</a></li>
<li><a href="#copyright">Copyright</a></li>
<li><a href="#license">License</a></li>
</ul>
<h2 id="usage">Usage</h2>
<pre><code>usage: imgtool [-h] [-a ROTANGLE] [-R] [-c] [-D] [-d directory]
               [-f format-string] [-i] [-n] [-p Pattern] [-q REQUIRED_TAG]
               [-r] [-t] [--thumb-dir directory] [-xt]
               [--thumb-geometry geometry] [-v] [-V] [-z geometry] [--debug]
               [--dumpkeys] [--help-geometry] [--help-format]
               [PATH [PATH ...]]</code></pre>
<h3 id="program-options">Program Options</h3>
<h4 id="rotation-angle">rotation-angle</h4>
<p>-a ROTANGLE, --rotation-angle ROTANGLE</p>
<h4 id="camera-names">camera-names</h4>
<p>-c, --camera-names Rename pictures that have an embedded camera name to</p>
<h4 id="output-directory">output-directory</h4>
<p>-d directory, --output-directory directory</p>
<h4 id="dry_run">dry_run</h4>
<p>-D, --dry_run Dry run: show what will be done without actually doing</p>
<h4 id="debug">debug</h4>
<p>--debug Enable debugging messages</p>
<h4 id="dumpkeys">dumpkeys</h4>
<p>--dumpkeys Dump all exif tag keys for first file and exit.</p>
<h4 id="format">format</h4>
<p>-f format-string, --format format-string</p>
<h4 id="ignore-no-exif">ignore-no-exif</h4>
<p>-i, --ignore-no-exif Ignore that a file has no EXIF data. Default is to</p>
<h4 id="no-clobber">no-clobber</h4>
<p>-n, --no-clobber Do not overwrite existing files. Files will be named</p>
<h4 id="pattern">pattern</h4>
<p>-p Pattern, --pattern Pattern</p>
<h4 id="required-tag">required-tag</h4>
<p>-q REQUIRED_TAG, --required-tag REQUIRED_TAG</p>
<h4 id="auto-rotate">auto-rotate</h4>
<p>-r, --auto-rotate Automatically rotate images.</p>
<h4 id="recurse">recurse</h4>
<p>-R, --recurse Recurse into sub-directories</p>
<h4 id="thumb-dir">thumb-dir</h4>
<p>--thumb-dir directory</p>
<h4 id="thumb-dir-1">thumb-dir</h4>
<p>--thumb-dir to override output directory.</p>
<h4 id="thumb-geometry">thumb-geometry</h4>
<p>--thumb-geometry geometry</p>
<h4 id="thumb-geometry-1">thumb-geometry</h4>
<p>--thumb-geometry to override default of 96x96, use</p>
<h4 id="thumbnail">thumbnail</h4>
<p>-t, --thumbnail Generate thumbnails in the same output path. Use</p>
<h4 id="verbose">verbose</h4>
<p>-v, --verbose Describe what is being done.</p>
<h4 id="version">version</h4>
<p>-V, --version Show version information and exit.</p>
<h4 id="exif-extract-thumb">exif-extract-thumb</h4>
<p>-xt, --exif-extract-thumb</p>
<h4 id="resize">resize</h4>
<p>-z geometry, --resize geometry</p>
<h2 id="geometry">Geometry</h2>
<p>Geometry can be specified as a percentage of the overall image or as a pair of width:height. Width and height are specified in pixels. If width is specified but no height, e.g., 1000: the image will be reized to a width of 1000px with a height calculated in relation to width to maintain the image aspect ratio. Conversely, height is specified without a width, e.g., :1000 will resize the image to 1000px high with a width calculated to maintain the aspect ratio. When the width and height are spcecified no attempt to maintain the aspect ratio is made. ## Order of operations Each image processed, if the operations are specified, has their operations peformed in this order: 1. Image resize 2. Auto-rotation 3. Dating and/or Renaming 4. Thumbnail generation ## Automatic Image Naming</p>
<p>Formatting filenames for automatic renaming is as follows: [@+]type.Tag#timefmt</p>
<p>Tags starting with @ have their spaces replaced with periods (.), Tags starting with + do not have spaces replaced. There are two types of tags, File and Exif. File Tags are:</p>
<pre><code>File.Name:  Filename of the image without extension
File.Ext:   Extension of filename, e.g., .JPG 
File.ext:   Extension of filename converted to lower-case, e.g., .jpg
File.Fullname: Full name of file with directories.
File.mtime: String representation YYYYMMDDhhmmss of the file&#39;s timestamp in
the filesystem.</code></pre>
<p>EXIF Tags vary by image and camera. The program exiftool may be useful in finding appropriate tags. When specifying EXIF Tags, they are formatted as Exif.Image.Model which results in a string, for one of my cameras, as 'NIKON D3400',by default the resultant string will have spaced replaced with periods (.), to suppress this behavior, precede them with a plus (+). E.g.:</p>
<pre><code>@Exif.Image.Make returns &#39;NIKON.D3400&#39; where +Exif.Image.Make 
returns &#39;NIKON D3400&#39; </code></pre>
<p>This conversion is done just before substituting the tag with its value.</p>
<h3 id="splitting-strings-in-tags">Splitting strings in tags</h3>
<p>Splitting the tag values can be done as an index of space separated words or as asubstring.</p>
<h4 id="indexing">Indexing</h4>
<p>To use an index, place the index number in brackets, e.g, <span class="citation">@Exif.Image.Make [1]</span> returns 'D3400' instead of 'NIKON D3400'. Index values start with 0.</p>
<h4 id="substrings">Substrings</h4>
<p>To use a substring, place the start and, optionally the length in parentheses. E.g,: <span class="citation">@Exif.Image.Make</span>(7,5) will return 'D3400' instead of 'NIKON D3400'. If the second value is omitted the length of the value, starting at the first number is presumed, so <span class="citation">@Exif.Image.Make</span>(7) will also result with 'D3400'</p>
<p>Any EXIF Tag present in the image EXIF header can be used to create all or part of a file name. For example, <code>@Image.Make[1]_@File.name@File.ext will create, from DSC_328.JPG a name of 'D3400_DSC_328.jpg'.</code></p>
<p>Note that the <span class="citation">@File</span> tags are never evaluated with a plus instead of an at-sign, and no indexing or substring operations are performed.</p>
<p>Time formatting, using the EIXF header's image time, is formatted using strftime(3) format, or with the following formatting keys:</p>
<pre><code>   #a     The abbreviated name of the day of the week according to the
          current locale.  (Calculated from tm_wday.)

   #A     The full name of the day of the week according to the current
          locale.  (Calculated from tm_wday.)

   #b     The abbreviated month name according to the current locale.
          (Calculated from tm_mon.)

   #B     The full month name according to the current locale.
          (Calculated from tm_mon.)

   #c     The preferred date and time representation for the current
          locale.

   #C     The century number (year/100) as a 2-digit integer. (SU)
          (Calculated from tm_year.)

   #d     The day of the month as a decimal number (range 01 to 31).
          (Calculated from tm_mday.)

   #D     Equivalent to #m/#d/#y.  (Yecch—for Americans only.  Americans
          should note that in other countries #d/#m/#y is rather common.
          This means that in international context this format is
          ambiguous and should not be used.) (SU)

   #e     Like #d, the day of the month as a decimal number, but a
          leading zero is replaced by a space. (SU) (Calculated from
          tm_mday.)

   #E     Modifier: use alternative format, see below. (SU)

   #F     Equivalent to #Y-#m-#d (the ISO 8601 date format). (C99)

   #G     The ISO 8601 week-based year (see NOTES) with century as a
          decimal number.  The 4-digit year corresponding to the ISO
          week number (see #V).  This has the same format and value as
          #Y, except that if the ISO week number belongs to the previous
          or next year, that year is used instead. (TZ) (Calculated from
          tm_year, tm_yday, and tm_wday.)

   #g     Like #G, but without century, that is, with a 2-digit year
          (00–99). (TZ) (Calculated from tm_year, tm_yday, and tm_wday.)

   #h     Equivalent to #b.  (SU)

   #H     The hour as a decimal number using a 24-hour clock (range 00
          to 23).  (Calculated from tm_hour.)

   #I     The hour as a decimal number using a 12-hour clock (range 01
          to 12).  (Calculated from tm_hour.)

   #j     The day of the year as a decimal number (range 001 to 366).
          (Calculated from tm_yday.)

   #k     The hour (24-hour clock) as a decimal number (range 0 to 23);
          single digits are preceded by a blank.  (See also #H.)
          (Calculated from tm_hour.)  (TZ)

   #l     The hour (12-hour clock) as a decimal number (range 1 to 12);
          single digits are preceded by a blank.  (See also #I.)
          (Calculated from tm_hour.)  (TZ)

   #m     The month as a decimal number (range 01 to 12).  (Calculated
          from tm_mon.)

   #M     The minute as a decimal number (range 00 to 59).  (Calculated
          from tm_min.)

   #n     A newline character. (SU)

   #O     Modifier: use alternative format, see below. (SU)

   #p     Either &quot;AM&quot; or &quot;PM&quot; according to the given time value, or the
          corresponding strings for the current locale.  Noon is treated
          as &quot;PM&quot; and midnight as &quot;AM&quot;.  (Calculated from tm_hour.)

   #P     Like #p but in lowercase: &quot;am&quot; or &quot;pm&quot; or a corresponding
          string for the current locale.  (Calculated from tm_hour.)
          (GNU)

   #r     The time in a.m. or p.m. notation.  In the POSIX locale this
          is equivalent to #I:#M:#S #p.  (SU)

   #R     The time in 24-hour notation (#H:#M).  (SU) For a version
          including the seconds, see #T below.

   #s     The number of seconds since the Epoch, 1970-01-01 00:00:00
          +0000 (UTC). (TZ) (Calculated from mktime(tm).)

   #S     The second as a decimal number (range 00 to 60).  (The range
          is up to 60 to allow for occasional leap seconds.)
          (Calculated from tm_sec.)

   #t     A tab character. (SU)

   #T     The time in 24-hour notation (#H:#M:#S).  (SU)

   #u     The day of the week as a decimal, range 1 to 7, Monday being
          1.  See also #w.  (Calculated from tm_wday.)  (SU)

   #U     The week number of the current year as a decimal number, range
          00 to 53, starting with the first Sunday as the first day of
          week 01.  See also #V and #W.  (Calculated from tm_yday and
          tm_wday.)

   #V     The ISO 8601 week number (see NOTES) of the current year as a
          decimal number, range 01 to 53, where week 1 is the first week
          that has at least 4 days in the new year.  See also #U and #W.
          (Calculated from tm_year, tm_yday, and tm_wday.)  (SU)

   #w     The day of the week as a decimal, range 0 to 6, Sunday being
          0.  See also #u.  (Calculated from tm_wday.)

   #W     The week number of the current year as a decimal number, range
          00 to 53, starting with the first Monday as the first day of
          week 01.  (Calculated from tm_yday and tm_wday.)

   #x     The preferred date representation for the current locale
          without the time.

   #X     The preferred time representation for the current locale
          without the date.

   #y     The year as a decimal number without a century (range 00 to
          99).  (Calculated from tm_year)

   #Y     The year as a decimal number including the century.
          (Calculated from tm_year)

   #z     The +hhmm or -hhmm numeric timezone (that is, the hour and
          minute offset from UTC). (SU)

   #Z     The timezone name or abbreviation.

   #+     The date and time in date format. (TZ) (Not supported in
          glibc2.)

   ##     A literal &#39;#&#39; character.

   Some conversion specifications can be modified by preceding the
   conversion specifier character by the E or O modifier to indicate
   that an alternative format should be used.  If the alternative format
   or specification does not exist for the current locale, the behavior
   will be as if the unmodified conversion specification were used. (SU)
   The Single UNIX Specification mentions #Ec, #EC, #Ex, #EX, #Ey, #EY,
   #Od, #Oe, #OH, #OI, #Om, #OM, #OS, #Ou, #OU, #OV, #Ow, #OW, #Oy,
   where the effect of the O modifier is to use alternative numeric
   symbols (say, roman numerals), and that of the E modifier is to use a
   locale-dependent alternative representation.</code></pre>
<p>(Taken from Linux strftime(3) manual page, from the Linux Man Pages Project, http://www.kernel.org/doc/man-pages) ## Some tips 1. Always backup data! 2. Before emplyoing this tool on a number of photos, be sure it will do what you want it to do using the -D or --dry-run option. This will tell you most of what operations are being done without actually doing them. 3. When using EXIF tags for renaming files from multiple camera make/models, do not use vendor specific tags, e.g. Exif.NikonFi.FileNumber as these may not be consistent across those cameras even for the same manufacturer. ## Installation</p>
<h2 id="pre-requisites">Pre-requisites</h2>
<p>imgtool requires the following python packages in order to work - pyexiv2 - https://github.com/escaped/pyexiv2 - Pillow - (pip install pillow)</p>
<p>The standard modules used are: - os - OS Dependent interfaces - sys - System interfaces - datetime, time - Date and time manipulation and conversions - re - Regular expression library - fnmatch, glob2, shutil - File globbing, matching and copying.</p>
<p>This tool was developed on Linux. While untested it may work on OSX and Windows provided these libraries are installed.</p>
<p>The installer script will install the files, based on what is in installer.json, to appropriate directories with the specified mode.</p>
<h3 id="running-the-installer-script">Running the installer script:</h3>
<pre><code>usage: installer [-h] [--bindir program-dir] [--docdir doccument-dir]
                 [--mandir man-dir] [--libdir library-dir]
                 [--sources source-list]

optional arguments:
  -h, --help              show this help message and exit
  --bindir program-dir    Directory to store executable(s)
  --docdir doccument-dir  Directory to store document(s)
  --mandir man-dir        Directory to store manual page(s)
  --libdir library-dir    Directory to store library files(s) (Not used for this tool)</code></pre>
<p>Running installer without arguments will install the program to /usr/bin, the manual page to /usr/man/man1, and this file to /usr/share/doc/imgtool. You must have appropriate access rights, e.g.:, sudo, to perform this install. The installer can write to other directories. Specifying 'none' as the deestination will prevent that part from being copied.</p>
<h2 id="issues">Issues</h2>
<ul>
<li>The documentation has some missing parts from the auto-generated stuff from reading the help output from imgtool.</li>
<li>Not fuly tested, but working on it.</li>
</ul>
<h2 id="warning">WARNING</h2>
<p>This tool is ALPHA. I have tested it in a limited environment and was written to work with my photographs. It may even be destructive. Backing up data is always a good idea before employing automatic tools that can recurse directories. If you break something, you own the remaining pieces.</p>
<h2 id="author">Author</h2>
<p>Nicole Stevens <span class="citation">[@github]</span>(https://github.com/nicciniamh)</p>
<h2 id="copyright">Copyright</h2>
<p>Copyright 2018 Nicole Stevens</p>
<h2 id="license">License</h2>
<p>Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in compliance with the License. You may obtain a copy of the License at <a href="http://www.apache.org/licenses/LICENSE-2.0" class="uri">http://www.apache.org/licenses/LICENSE-2.0</a></p>
</body>
</html>
